<!doctype html>
<html lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-109072453-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-109072453-1');
  </script>
  <meta charset="utf-8">
  <title>Philot - Fetching a DOM element's next sibling with Vanilla JavaScript</title>

  <link rel="shortcut icon" href="/assets/images/favicon.ico" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="This week when building a component I stumbled upon an issue that got the thinking a little. We needed a button that would be future proof and take users to ...">

  <meta property="og:site_name" content="">
  
  <meta property="og:title" content="Fetching a DOM element's next sibling with Vanilla JavaScript">
  <meta property="og:type" content="article">
  <meta property="og:description" content="This week when building a component I stumbled upon an issue that got the thinking a little. We needed a button that would be future proof and take users to the next section of the page, regardless of what that section would be.
"/>
  
  
  <meta property="article:published_time" content="2020-08-18T00:00:00-04:00">
  <meta property="article:author" content="/about/">
  
  <meta property="og:url" content="/2020/08/18/javascript-get-element-next-sibling-copy.html" />
  
  <meta itemprop="keywords" content="" />
  
  
   
  
  <meta property="og:image" content="https://www.philot.ca/assets/images/philot-meta-default.jpg">
  
  <meta name="twitter:site" content="@vphilot">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <script src="/assets/js/swup.js"></script>
  <script src="/assets/js/app.js"></script>
</head>

<body>
  <nav class="swup">
    <div class="navigation__toggle is-hidden-desktop"></div>
<nav class="level" id="navigation">
  <div class="container has-padding-lr-1">
    <div class="level-left">
    </div>
    <div class="level-right is-uppercase">
      
      <div class="column is-1-desktop is-size-7 has-spacing-lg has-text-right">
        <a href="/" >
          Home
        </a>
      </div>
      
      <div class="column is-1-desktop is-size-7 has-spacing-lg has-text-right">
        <a href="/about.html" >
          About
        </a>
      </div>
      
      <div class="column is-1-desktop is-size-7 has-spacing-lg has-text-right">
        <a href="/blog.html" >
          Blog
        </a>
      </div>
      
      <div class="column is-1-desktop is-size-7 has-spacing-lg has-text-right">
        <a href="/works.html" >
          Work
        </a>
      </div>
      
    </div>
  </div>
</nav>
    <section class="section" id="header">
    <div class="container has-padding-lr-1">

        <div class="columns is-mobile is-multiline is-vbaseline">
            <div class="column is-4-desktop is-8-mobile">
                <h1 class="title is-1"><a href="/">Vinícius Philot</a></h1>
            </div>
            <div class="column is-3-desktop is-8-mobile">
                <p class="has-spacing-sm is-size-7">Front End UI Developer</p>
            </div>
            <div class="column is-3-desktop is-6-mobile has-spacing-sm">
                <a href="mailto:vphilo@gmail.com?subject=Hey%2C%20nice%20site%20you%20have">
                    <p class="has-spacing-sm is-size-7">vphilot@gmail.com</p>
                </a>
                </div>
            <div class="column is-2-desktop is-12-mobile">
                <a 
                aria-label="check my Linkedin in a new tab" 
                href="https://www.linkedin.com/in/vphilot/?locale=en_US" 
                target="_blank"
                tabindex="0"
                >
                    <i aria-hidden="true" class="icon icon-linkedin">&#xf0e1;</i>
                </a>
                <a 
                aria-label="check my Twitter in a new tab" 
                href="https://twitter.com/vphilot" 
                target="_blank"
                tabindex="0"
                >
                    <i aria-hidden="true" class="icon icon-twitter">&#xf099;</i>
                </a>
                <a 
                aria-label="check my Instagram in a new tab"
                href="https://instagram.com/vphilot" 
                target="_blank"
                tabindex="0"
                >
                    <i aria-hidden="true" class="icon icon-instagram">&#xf16d;</i>
                </a>
                <a 
                aria-label="check my Github in a new tab" 
                href="https://github.com/vphilot" 
                target="_blank"
                tabindex="0"
                >
                    <i aria-hidden="true" class="icon icon-github">&#xf113;</i>
                </a>
                <a 
                aria-label="check my Codepen in a new tab" 
                href="https://codepen.io/vphilot/" 
                target="_blank"
                tabindex="0"
                >
                    <i aria-hidden="true" class="icon icon-codepen">&#xf32c;</i>
                </a>
                <a 
                aria-label="check my Spotify in a new tab" 
                href="https://open.spotify.com/user/12183629233" 
                target="_blank"
                tabindex="0"
                >
                    <i aria-hidden="true" class="icon icon-spotify">&#xf1bc;</i>
                </a>
            </div>
        </div>
    </div>
</section>
  </nav>
  <main class="swup transition-fade"   style="background-color: #f4f4f4" >
    <section class="section" id="post-fetching a dom element's next sibling with vanilla javascript">
    <div class="container has-padding-lr-1">
        <div class="columns is-mobile is-multiline is-centered">
            <div class="column is-8-desktop is-12-mobile">
                <h1 class="title is-1 has-spacing-sm swup-delay transition-slide">Fetching a DOM element's next sibling with Vanilla JavaScript</h1>
                <div class="columns is-mobile is-multiline">
                    <div class="column is-5-desktop is-6-mobile has-spacing-sm">
                        <p class="has-spacing-sm is-size-6 has-border-black swup-delay transition-slide">
                            18 Aug 2020
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <article class="swup-delay transition-fade">
            <div class="columns is-mobile is-multiline is-centered">
                <div class="column is-8-desktop is-12-tablet is-12-mobile">
                    <p>This week when building a component I stumbled upon an issue that got the thinking a little. We needed a button that would be future proof and take users to the <strong><em>next section</em></strong> of the page, regardless of what that section would be.</p>

<p>There’s a native implementation for this use case, the <code class="language-plaintext highlighter-rouge">nextElementSibling</code> property:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">nextNode</span> <span class="o">=</span> <span class="nx">elementNodeReference</span><span class="p">.</span><span class="nx">nextElementSibling</span><span class="p">;</span> 
</code></pre></div></div>

<p>However, the native option will return <strong>any</strong>  DOM tree sibling, including scripts, styles, and other tags. For my particular case, I was looking for elements that were actually rendered on the page. Here’s the basic acceptance criteria of the function we’ll be writing:</p>

<ul class="has-bullet">
  <li>We want <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;link&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;style&gt;</code> tags to be disregarded as valid results</li>
  <li>The function must check for null values (in case there’s no valid sibling)</li>
  <li><strong>Vanilla JS</strong> only</li>
</ul>

<h3 class="intro title is-3 has-text-weight-normal has-line-spacing-tall" id="outlining-the-function">Outlining the function</h3>

<p>Our helper function will accept an <code class="language-plaintext highlighter-rouge">element</code> argument which is the current element whose sibling we want to return:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">function</span> <span class="nx">getElementNextSibling</span><span class="p">(</span><span class="nx">element</span><span class="p">){}</span>
</code></pre></div></div>

<p>A pretty straightforward way of getting all of the siblings is by:</p>
<ul class="has-bullet">
  <li>Going <strong>one level up</strong> to its parent (JS property <code class="language-plaintext highlighter-rouge">parentNode</code>)</li>
  <li>Descending back again <strong>one level down</strong> to get all of the parent node’s children (JS property <code class="language-plaintext highlighter-rouge">children</code>)</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">function</span> <span class="nx">getElementNextSibling</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">children</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">children</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>Now we can do all sorts of mapping, sorting, and filtering methods in our <code class="language-plaintext highlighter-rouge">children</code> object to find the siblings! <strong>Except that we can’t</strong>. Using <code class="language-plaintext highlighter-rouge">element.parentNode.children</code> will return a <code class="language-plaintext highlighter-rouge">NodeList</code> object that doesn’t accept all the Array methods we’re looking for at the moment. To make this work, we need to create a new instance of <code class="language-plaintext highlighter-rouge">Array</code> type by using the following ES6 syntax:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">function</span> <span class="nx">getElementNextSibling</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">children</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">children</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre></div></div>

<h3 class="intro title is-3 has-text-weight-normal has-line-spacing-tall" id="filtering-the-results">Filtering the results</h3>

<p>Now that we can use the <code class="language-plaintext highlighter-rouge">filter</code> method to return find what we’re looking for in the (sometimes) large children array, it’s important to establish what types of DOM nodes we care about:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">function</span> <span class="nx">getElementNextSibling</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">children</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">children</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">siblings</span> <span class="o">=</span> <span class="nx">children</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">child</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="c1">//but what are we looking for really?</span>
        <span class="p">})</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>Since every single element in this array is a DOM <code class="language-plaintext highlighter-rouge">Node</code>, we can leverage some properties of this object to find what we’re looking for.</p>

<p>The first one is <code class="language-plaintext highlighter-rouge">node.nodeType</code>. The <code class="language-plaintext highlighter-rouge">nodeType</code> property has a value that can help us identify quickly target the value <code class="language-plaintext highlighter-rouge">1</code>, which is <code class="language-plaintext highlighter-rouge">ELEMENT_NODE</code>. Many other types are available though, <a href="https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType">click here to see the full NodeType reference on MDN</a>.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">if</span> <span class="p">(</span><span class="nx">child</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>

    <span class="p">}</span>
</code></pre></div></div>

<p>This is not enough however, as <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;style&gt;</code>, and <code class="language-plaintext highlighter-rouge">&lt;link&gt;</code>tags will still be processed as valid results. To resolve this issue, we can leverage another property of the <code class="language-plaintext highlighter-rouge">Node</code> object called <code class="language-plaintext highlighter-rouge">tagName</code>:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">if</span> <span class="p">(</span><span class="nx">child</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">child</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">SCRIPT</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">child</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">LINK</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">child</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">STYLE</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//will return the visible, rendered elements only</span>
    <span class="p">}</span>
</code></pre></div></div>

<h3 class="intro title is-3 has-text-weight-normal has-line-spacing-tall" id="finding-who-is-the-next-sibling">Finding who is the next sibling</h3>

<p>So far, we’re able to return siblings of our element (by getting all of the children of its parent). Here’s how the function looks so far:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">function</span> <span class="nx">getElementNextSibling</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">children</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">children</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">siblings</span> <span class="o">=</span> <span class="nx">children</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">child</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">child</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">child</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">SCRIPT</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">child</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">LINK</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">child</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">STYLE</span><span class="dl">"</span>
        <span class="p">})</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>Now we need a way to find the next direct sibling of our element, considering all the elements present in the <code class="language-plaintext highlighter-rouge">siblings</code> array match our criteria. A simple way to accomplish this is by:</p>

<ul class="has-bullet">
  <li>Finding where our <strong>current element</strong> stands in the siblings <code class="language-plaintext highlighter-rouge">array</code> by getting its <code class="language-plaintext highlighter-rouge">index</code></li>
  <li>Finding what the next direct sibling is by simply adding <code class="language-plaintext highlighter-rouge">1</code> to that index</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">const</span> <span class="nx">currentElementIndex</span> <span class="o">=</span> <span class="nx">siblings</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">nextElementIndex</span> <span class="o">=</span> <span class="nx">currentElementIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<p>Finally, we add a last check just to ensure our function is returnin an element (since there is a possibility our current element is the last on its parent’s hierarchy). This is how the final result looks like:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">function</span> <span class="nx">getElementNextSibling</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">children</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">children</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">siblings</span> <span class="o">=</span> <span class="nx">children</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">child</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">child</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">child</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">SCRIPT</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">child</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">LINK</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">child</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">STYLE</span><span class="dl">"</span>
        <span class="p">});</span>

        <span class="kd">const</span> <span class="nx">currentElementIndex</span> <span class="o">=</span> <span class="nx">siblings</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">nextElementIndex</span> <span class="o">=</span> <span class="nx">currentElementIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">siblings</span><span class="p">[</span><span class="nx">nextElementIndex</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">siblings</span><span class="p">[</span><span class="nx">nextElementIndex</span><span class="p">];</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<h3 class="intro title is-3 has-text-weight-normal has-line-spacing-tall" id="working-with-ie-and-es5">Working with IE and ES5</h3>

<p>Since the <code class="language-plaintext highlighter-rouge">Array.from</code> method might return an error on Interner Explorer even when using Babel, there’s a last modification we can implement to make this function compatible with older browsers (if that’s included in your target audience):</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">getElementNextSibling</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">children</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">children</span><span class="p">);</span>
    <span class="c1">// everything else stays the same</span>
<span class="p">}</span>
</code></pre></div></div>

                </div>
            </div>
        </article>
        <div class="columns is-mobile is-multiline is-centered">
            <div class="column is-8-desktop is-12-mobile">
                <div class="columns is-mobile is-multiline is-centered">
                    
                        <div class="column is-4-desktop is-6-mobile">
                            <a href="/2020/07/02/building-a-simple-back-to-top-button-trigger-with-css-and-javascript.html">
                                <h1 class="intro title is-4 has-text-weight-light has-line-spacing-tall has-text-left">
                                    Prev
                                </h1>
                                <svg x="0px" y="0px" viewBox="0 0 200 10">
                                    <polyline points="6,0 1,5 6,10 " />
                                    <line x1="1" y1="5" x2="200" y2="5" />
                                </svg>
                            </a>
                        </div>
                    
                    <div class="column is-4-desktop is-hidden-mobile">
                    </div>
                    
                        <div class="column is-4-desktop is-6-mobile">
                            <a href="/2021/01/05/building-a-new-start-page-with-svelte.html">
                                <h1 class="intro title is-4 has-text-weight-light has-line-spacing-tall has-text-right">
                                    Next
                                </h1>
                                <svg x="0px" y="0px" viewBox="0 0 200 10">
                                    <polyline points="194,0 199,5 194,10 " />
                                    <line x1="0" y1="5" x2="199" y2="5" />
                                </svg>
                            </a>
                        </div>
                    
                </div>
            </div>
        </div>

    </div>
</section>
    <section id="footer" class="container has-padding-1">
    <div class="columns is-multiline is-centered">
        <div class="column is-12">
            <p class="is-size-7 has-text-grey has-spacing-sm">This website was developed with <i class="icon icon-heart-empty" aria-hidden="true">&#xe800;</i> and <a
                    href="https://github.com" target="_blank" id="footerDisplay">github</a> </p>
        </div>
    </div>
</div>
  </main>


</body>


</html>